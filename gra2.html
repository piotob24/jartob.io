<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Gra 2 – Zgadnij zwierzę</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; background:#f1f2f6; margin:0; padding:20px; }
    h1 { color:#0a3d62; margin-top:0; }
    .controls { margin: 10px 0 15px; display:flex; gap:12px; justify-content:center; align-items:center; flex-wrap:wrap; }
    .btn {
      padding:10px 18px; border:none; border-radius:10px; background:#0a3d62; color:#fff; cursor:pointer;
      font-weight:bold; transition:transform .15s ease, opacity .15s ease;
    }
    .btn:disabled { opacity:.5; cursor:not-allowed; }
    .info { font-size:18px; }
    .animals { display:flex; justify-content:center; gap:20px; margin:20px auto; flex-wrap:wrap; max-width:900px; }
    .animals button { border:none; background:none; cursor:pointer; transition: transform .15s ease; }
    .animals button:focus { outline: 3px solid #ffcc00; border-radius:12px; }
    .animals button:hover { transform: scale(1.05); }
    .animals img { width:180px; height:180px; border:3px solid #ccc; border-radius:12px; object-fit:cover; background:#fff; }
    .msg { min-height: 28px; color:#333; margin-top:10px; }
  </style>
</head>
<body>
  <h1>Gra 2 – Zgadnij zwierzę po dźwięku</h1>
  <p>Posłuchaj dźwięku i kliknij na właściwe zwierzę 🎧</p>

  <div class="controls">
    <button id="playSoundBtn" class="btn" onclick="playSound()">▶️ Odtwórz dźwięk</button>
    <button id="nextBtn" class="btn" onclick="nextRound()">🔄 Następne</button>
    <span class="info">Punkty: <strong id="score">0</strong></span>
    <span class="info">Rekord: <strong id="highscore">0</strong></span>
  </div>

  <div id="animals" class="animals"></div>

  <div id="message" class="msg"></div>

  <script>
    // lista dostępnych zwierząt (dodaj pliki PNG/JPG i MP3 w folderze media/)
    const allAnimals = [
      {name:'cow', label:'Krowa', img:'media/cow.png', sound:'media/cow.mp3'},
      {name:'dog', label:'Pies', img:'media/dog.png', sound:'media/dog.mp3'},
      {name:'cat', label:'Kot', img:'media/kitty.png', sound:'media/cat.mp3'},
      {name:'sheep', label:'Owca', img:'media/sheep.png', sound:'media/sheep.mp3'},
      {name:'horse', label:'Koń', img:'media/horse.png', sound:'media/horse.mp3'},
      {name:'duck', label:'Kaczka', img:'media/duck.png', sound:'media/duck.mp3'},
      {name:'snake', label:'Wąż', img:'media/snake.png', sound:'media/snake.mp3'}
    ];

    let score = 0;
    let highscore = parseInt(localStorage.getItem('guessAnimalHS')||'0',10);
    let correctAnimal = null;
    let options = [];

    const scoreEl = document.getElementById('score');
    const hsEl = document.getElementById('highscore');
    const msgEl = document.getElementById('message');
    const animalsDiv = document.getElementById('animals');

    hsEl.textContent = highscore;

    function shuffle(arr) {
      for (let i=arr.length-1;i>0;i--) {
        const j=Math.floor(Math.random()*(i+1));
        [arr[i],arr[j]]=[arr[j],arr[i]];
      }
      return arr;
    }

    function nextRound() {
      msgEl.textContent='';
      animalsDiv.innerHTML='';
      // losuj 3 różne zwierzęta z puli
      options = shuffle([...allAnimals]).slice(0,3);
      // losuj jedno z nich jako poprawne
      correctAnimal = options[Math.floor(Math.random()*options.length)];
      // renderuj przyciski
      options.forEach(animal=>{
        const btn=document.createElement('button');
        btn.setAttribute('aria-label',animal.label);
        btn.onclick=()=>selectAnimal(animal);
        const img=document.createElement('img');
        img.src=animal.img;
        img.alt=animal.label;
        btn.appendChild(img);
        animalsDiv.appendChild(btn);
      });
    }

    function playSound() {
      if (!correctAnimal) return;
      const audio=new Audio(correctAnimal.sound);
      audio.play().catch(()=>{});
    }

    function selectAnimal(animal) {
      if (!correctAnimal) return;
      if (animal.name===correctAnimal.name) {
        score++;
        msgEl.textContent='✅ Brawo! To było poprawne.';
      } else {
        msgEl.textContent=`❌ To nie ${animal.label}. Poprawna odpowiedź: ${correctAnimal.label}.`;
        score=0;
      }
      if (score>highscore) {
        highscore=score;
        localStorage.setItem('guessAnimalHS',String(highscore));
        hsEl.textContent=highscore;
      }
      scoreEl.textContent=score;
    }

    // start gry
    nextRound();
  </script>
</body>
</html>
